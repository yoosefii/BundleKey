{%extends 'base.html'%}

{%block head%}
    <title>BundleKey | Feed</title>
{%endblock%}

{%block main_content%}
    <div class="posts-container">
        {%if not posts%}
        <h2>No posts yet... be the first!</h2>
        {%else%}
            {%for post in posts%}
            <div class="post-div" id="post-{{post.object.id}}">
                <div class="first-row">
                    <span class="icon"><i class="fa-solid fa-user"></i></span>
                    <span class="username"><a href="{{url_for('profile', user_id=post.object.poster_id)}}">{{post.object.poster_username}}</a></span>
                    <span class="published">• {{post.time_ago}}</span>
                    {%if current_user.username == post.object.poster_username%}
                    <div class="options" tabindex="0">⋮
                        <div class="drop-down-menu">
                            <a href="{{url_for('edit', type='post', id=post.object.id)}}" class="option">Edit</a>
                            <a href="{{url_for('delete', type='post', id=post.object.id)}}" class="option">Delete</a>
                        </div>
                    </div>
                    {%endif%}
                </div>
                <div class="content">{{post.object.content | e | replace('\n', '<br>' | safe)}}</div>
                <div class="interactions">
                    <form class="vote" action="{{url_for('vote', parent_type='post', parent_id=post.object.id)}}" method="POST">
                        <label><input type="radio" name="vote" value="like"
                            onchange="this.form.submit()"> {%if current_user.id in post.likes%} <i class="fa-solid fa-thumbs-up"></i>
                            {%else%} <i class="fa-regular fa-thumbs-up"></i> {%endif%} {%if post.likes | length > 0 %} <span>{{post.likes | length}}</span> {%else%} <span></span> {%endif%} </label>
                        <label><input type="radio" name="vote" value="dislike"
                            onchange="this.form.submit()"> {%if current_user.id in post.dislikes%} <i class="fa-solid fa-thumbs-down"></i>
                            {%else%} <i class="fa-regular fa-thumbs-down"></i> {%endif%} {%if post.dislikes | length > 0 %} <span>{{post.dislikes | length}}</span> {%else%} <span></span> {%endif%}</label>
                    </form>
                    <a href="{{url_for('comments_page', post_id=post.object.id)}}"><i class="fa-regular fa-comment-dots"></i></a>
                </div>
            </div>
            {%endfor%}
        {%endif%}
    </div>
{%endblock%}

{%block side_content%}

{%endblock%}